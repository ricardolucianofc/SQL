BEGIN TRAN TESTE

 

DECLARE

@CAMPO_ID AS VARCHAR(MAX),

@CAMPO1 AS VARCHAR(MAX),

       @CAMPO2 AS VARCHAR(MAX),

       @CAMPO3 AS VARCHAR(MAX)

 

SELECT * FROM  TABELA_DESTINO

 

DECLARE RS CURSOR FOR

       SELECT CAMPO_ID, CAMPO1, CAMPO2, CAMPO3 FROM TABELA_ORIGEM

 

OPEN RS;

 

FETCH NEXT FROM RS INTO @CAMPO_ID, @CAMPO1, @CAMPO2, @CAMPO3;

 

WHILE @@FETCH_STATUS = 0

       BEGIN

 

             UPDATE TABELA_DESTINO

             SET CAMPO1 = @CAMPO1

                 CAMPO2 = @CAMPO2

                 CAMPO3 = @CAMPO3

             WHERE CAMPO_ID = @CAMPO_ID

 

FETCH NEXT FROM RS INTO @CAMPO_ID, @CAMPO1, @CAMPO2, @CAMPO3;

       END

 

CLOSE RS;

 

DEALLOCATE RS;

 

SELECT * FROM  TABELA_DESTINO

 

ROLLBACK TRAN TESTE

--COMMIT TRAN TESTE